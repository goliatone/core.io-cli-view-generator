#!/usr/bin/env node

'use strict';

const prog = require('caporal');
const pkg = require('../package.json');
const GenerateCommand = require('../commands/generate');

prog
    .version(pkg.version)
    .description(pkg.description)
    .command('generate', 'Generate schema from model data')
    .argument('[source]', 'Path to directory with models', /.*/, GenerateCommand.DEFAULTS.source)
    .argument('[output]', 'Filename for output.', /.*/, GenerateCommand.DEFAULTS.output)
    .option('--clean', 'Should the contents of [source] be removed before running', prog.BOOL, GenerateCommand.DEFAULTS.options.clean)
    .option('--templates <path>', '<path> to template files', null, GenerateCommand.DEFAULTS.options.templates)
    .action((args, options, logger) => {

        const command = new GenerateCommand({
            logger: logger
        });

        args.options = options;

        command.execute(args).catch(logger.error);
    });

prog.parse(process.argv);
